# tps-sw 网表排查清单

网表文件：`hardware/tps-sw/netlist.enet`

适用硬件：`tps-sw`

说明：本清单基于**网表连线**与各器件**数据手册/典型应用**对照，不包含 PCB 布局/走线/ESD 结构的版图级验证。器件位号以当前网表为准。

## 关键器件定位（来自网表）

- `TPS55288`：`U14`
- `SW2303`：`U16`
- `CH318T`：`U1/U2`
- `LT4532B-351MGF`（隔离链路磁性器件）：`L1`
- `RT9013-33GB`：`U5`
- `CH412K`（ESD 阵列）：`D2/D3`
- `ECMF02-2AMX6`（USB2.0 EMI/ESD）：`L3`
- `CH442E`（USB2.0 数据开关）：`U7/U8`

## 总体结构（快速确认）

- [x] 网表格式为 EasyEDA `.enet`（JSON），连通性来自各器件 `pinInfoMap[*].net`
- [x] 隔离域 `UGND/UVBUS/UVCC` 与主域 `GND/VIN/+5V/3V3` 未发现同一器件同时连接 `UGND` 与 `GND`
- [x] USB 隔离链路：`U1(CH318T)` 的 `DMX_U/DPX_U` ↔ `L1` ↔ `U2(CH318T)` 的 `DMX_D/DPX_D`

## P0：必须优先修复（不修可能不工作/可靠性极差）

### TPS55288（U14，Buck-Boost）

- [x] 你已确认 PCB 上 `U14` 的 `PGND` 与 `AGND` 处直接短接（因此 `AGND_TPS` 不会“浮地”）。
- [ ] 由于网表里 `AGND_TPS` 仍是独立网络，建议在原理图中增加 net-tie/0Ω（或等效做法）把 `AGND_TPS` 与 `GND/PGND` 的单点连接“显式化”，避免后续审阅/改版误判。
- [ ] 数据手册建议 `PGND plane` 与 `AGND plane` 在 `VCC` 去耦电容地端单点相连；请确认该短接点在版图上**等效位于 `C65(U14 VCC 去耦)` 的地端附近**，并确保高 di/dt 的功率回流不穿过 `AGND` 参考区域。
- [ ] 复核隔离边界：`UGND` 与 `GND` 的分割是否符合预期，避免 ESD/TVS/外壳等把隔离域与主域“意外短接”。

### RT9013-33GB（U5，LDO：UVBUS→UVCC）

- [ ] 网表中 `U5` 存在一个悬空引脚（`pin4`：net 为空）。若该脚为 `EN`（或其他不可悬空的功能脚），建议：直接接 `UVBUS`（常开）或接 MCU 控制并加明确上拉/下拉。

### CH412K（D2/D3，ESD 阵列）

- [ ] `D2/D3` 的 `VCC` 连接到 `P0_VBUS/P1_VBUS`，且未看到 `VCC` 就近 `0.1µF` 去耦；若器件手册要求 `VCC` 去耦或推荐 `VCC=3.3V`，建议：按手册补齐去耦/供电策略，或更换为无需 `VCC` 的 TVS/ESD 方案。

## P1：高风险/功能偏差（按需求决定）

### CH318T（U1/U2，USB 隔离/Hub）

- [ ] 晶振网络与手册推荐不一致：目前仅 `XO` 侧有 `30pF` 到地（`C16/C17`），`XI` 侧无对地电容；手册推荐晶体两侧各有对地电容并给出推荐值。建议按手册重构，并结合 `X2/X3(20MHz, CL=9pF)` 重新选值/校核起振裕量与频偏。
- [ ] 料号 OTP 版本（A1/A2）未在网表中体现；手册说明不同丝印会改变上位机模式下 `DMU/DPU` 的端口角色。建议记录来料丝印并与 `P0/P1` 的端口规划一致。
- [ ] `LED/MODE` 外围：`U2` 的 `LEDD` 既有 `R9=5.1kΩ→GND` 模式下拉，又通过 `R8=1kΩ` 接到 LED 网络；建议按手册的模式配置电路把模式电平做成“单一、明确”，避免被 LED 网络干扰。
- [ ] `R39`（n.c.）：若装配为 `LEDD → MCU(GPIO6)` 的采样通道，仅允许 MCU 以高阻输入读取（禁用内部上下拉/禁止输出驱动），避免反向干扰 `LEDD` 的模式/指示逻辑。

### SW2303（U16，USB‑C/PD 控制）

- [x] `VFB/FB_TPS` 分压：`R31=100kΩ (VOUT_TPS→FB_TPS)`、`R33=31.6kΩ (FB_TPS→AGND_TPS)`；请对照手册确认该模式与参数符合预期。
- [ ] 若产品需求包含 QC/BC1.2 等依赖 `DP/DM` 的快充兼容，请确认 SW2303 的 `DP/DM` 引脚在网表/原理图中已接入（否则仅剩 Type‑C/PD 走 CC）。

## P2：一致性/工程性改进（建议）

### ECMF02-2AMX6（L3，USB2.0 EMI/ESD）

- [x] `L3` 对 `DMU/DPU` 做 EMI/ESD；网表中存在一个 `NC` 悬空引脚（net 为空）以及 `UGND` 参考地，连接方式与数据手册一致。
- [ ] 注意：ECMF02 的 ESD 只覆盖穿过它的差分对，不覆盖 `CC/VBUS`；若接口需 IEC 等级，请为 `CC/VBUS` 单独规划保护器件与布局。

### USB-C：CC 电阻与 ESD

- [ ] 若存在 Type‑C 受电端（Sink），请确认 `CC1/CC2` 的 `Rd=5.1kΩ→(U)GND` 配置明确且一致，不留悬空与歧义。
- [ ] `CC` 线若需认证/强健性，请补充专用 ESD/TVS 通道，并按器件手册的走线/接地要求布局。

### CH442E（U7/U8，USB2.0 数据开关）

- [ ] 上电/复位期间 MCU IO 可能浮空导致 USB 数据路径抖动。建议为 `IN/EN#` 等控制脚提供确定上拉/下拉，或设计成默认断开再由固件使能。

## 待确认（需要你给出需求/实物信息）

- [ ] 下行 USB‑C 口的协议需求：仅 PD（CC）还是还要兼容 QC/BC1.2（DP/DM）？
- [ ] `CH318T` 实物丝印是 A1 还是 A2？（决定上位机模式下 `DMU/DPU` 的端口角色）
- [ ] `CC/VBUS` 的 ESD 目标等级与测试标准（IEC 61000‑4‑2/‑4‑5 等）是什么？
